---
layout: post
cover: 'assets/images/cover6.jpg'
title:  CodeEngn Advance 2
date:   2017-04-30 12:09:26
tags: fiction
subclass: 'post tag-fiction'
categories: 'pjya0321'
navigation: True
logo: 'assets/images/ghost.png'
---

## 2번 문제풀이
-----
문제 : 정답은 무엇인가?

![1](https://lh3.googleusercontent.com/Pgno5P4dB3aE5nYlwKmWkyCf3whjmzWSceemWT58i6GnVNq-2S5bRxq5JRLTJXWjiStEqsU-bFTf1RvcE3-7PHKVBTfmgMw-yvwCSHdoj5XeIuVg6vlJBze2T2P85kODwCzO8AjZETGW1uWt3cciegOEujEWrV29mLtKM8O24LEgXglkV-CluKrQ_yZLf9zMR61jT9KW-FqkV2kCsmMmjIq43BWEQGc1DpaYdQxWSFnFfy2O3NqpS-H9Ar787B8r7Xz7h-cUBaHwGwfxydKWV0GvFW38azxL0kJlFG4j9dThmOLKplnq3wKiF5F7hD5evmbplEHwdK0iyVvD-YNlfWcGTfrQYPtW5laropcBuiDmH6xNJarIkc25GQ_ZxUgQOetB7tFTGkDybqXxq1Qc8zEz2UwUDAnRq0MusJSR65aN7sMqTtUeWYdcaR6BqmFVIsYYhAauB75bIxJJWLh22SaUmte_m1ffLNjYTJ-1eWnLHz2Jlpm8qmKEGrcNUeSIYoMUs3FsdPl2l_fHl5xowFiCt_nrjjlvhSF9E5w7n1gvS6r1ZUhy-9CraewqaCMRGWlW4WaMPadTA8r0luMPFLNHmjPAjTRN-1p71DaQZlP8dsifYnY=w669-h182-no)

일단 파일을 실행해보니 그림 4처럼 도스창에 패스워드를 입력 받는다. 아무 값이나 입력하고 엔터를 눌렀더니 자동으로 종료가 되었다. 별다른 패킹은 되있지 않고, C++로 코딩된 프로그램이다.
패스워드 입력함수 직전에 브레이크포인트를 걸고 패스워드엔 임의로 12345를 넣었다.

![2](https://lh3.googleusercontent.com/f-w9iPeXZhQTSbK1nUDFejRZt_-uGBT9CrXhc-WnW9MyomiJZh2---YNUWePUu7k4l-OUtYorT2374_hjIlKnB2I5-QdPimtOtDsniJ2OYztdWeEQoZ19h3lhnduC6Cs-KMemReXeJDYCSJxIcZtiOKfmcwQfXll0ieWioPkkNzVyWzJlUzR_HceIBYw_2yyBIYlr5r9THT-W3fZIuwoHoQzo2jYei4bHGn_YL5zwLaEkg2Q2cXjfpCWMzYO-G5vbU8BgICQ8RMDK5l2TryqrdMMshgeNzlUJK5S8BHR6pY7SPnXYPxUpcvSm_U2goxdI1tVl05FddCQZKrETDEhJZYvJ3ckKoJyC80rXcB4gOHeGkxbVQU48jw3kuGLGa-dD7wi0g7nHohCyRGIQUFvPWI5DiXIbBG9GJKsP8FJS3RAIJufHajeN_rUXjvsgOZogMr64qYHPdhcMzDVnP8Q-Erxy2D1-vhklB8-QxvbRIfZu9BJ-erebQEapNLSwp9qyOGD_4ID5EGxvvQogGno6TTyr7oG0UjMLs-VG1tUgQXpZ6ppyzxS472vcTFboOv-AT6gUxZgL8tHrAzVZv_sWVwXc7C5Q3RD3G2n4hhnejvnUO8=w733-h72-no)

패스워드를 입력 받고 아래 내용처럼 64번반복하며 이런저런 연산을 하는데 처음엔 이부분이 핵심일 꺼라 생각하고 자세히 확인해 봤지만 그림 5 의 내용만 64번 반복해서 넣고 별다른 일은 인행되지 않은 걸로 판단했다.

![3](https://lh3.googleusercontent.com/o2uzyg8zwsxj43B0oVA1Fhy_MDfOQmyFiGeMlovIojc0pUzP5630EFnn0MIXthw8oyULVaY3VJlWPbQidoV21gfkaiB_hGFaMv14J5maK_AQgNy4di7m5CZzECa9v0zEugZPwH41avNKA6oPBa5qT5tP39yQiWIJvirFp4QNHNi2B5w7A4quVzB4HPxZBCCecvuys2_FcEmRZAT_ATFM9DrkofjDx177I4DSGt17HT-dCQ1Yq0uQdXcZ1HGgp8Hqf0MM7hTDD0QLImV9vgNNzKJWBlyjlpNl_7BRndyUP_e5DQM2WRrmLPU7Mqfp5ZiGxedD2lm3kT4enPExDq_UV0HFthKrW5RV1OHDbel17w9NGF5RlO3Ewoc8djJF7ZFdaNdrrooXXk6ei59fm5F9TxS_48WK8l7JXQEklOV04_d5bCoZZqeHlWj2J6LF36XSc2MHK5x4mnaUb_COG1lJByuhFCNAQB0YGArsfnKu-KdffNDs8JxZWqKcd7EQqRB6y8sbpPBxFdQm_TFYtBAmybTsqW5yCbclgDlm-WZ55xEkvnP9asa9h_TmCdIERtDN5MSktcv-YwSqcERcvebsFZlsGg8eGcus-DdJpx2GxxAcgfM=w385-h497-no)

![4](https://lh3.googleusercontent.com/tqMmKjvgllK43u75BRIb4EaT682NXQSor7Qx2_jVCBZbl3bc8u5hT87pOnTZtyfuPsJTv3WapHu37c36mOTRtP9zztNEib4ZPPL2L_JHHoiIMmrvOduDfkdBWjTRmqztDi9z_OnXZupwJf5ry0ZXHZBHBfyYl1ItJOcy3Pd-eHGcdoWyMEhML8r0ZqJz6NxsohWkBnHO-3dDtDJXHltWNLksboKyJNhvz_x8FVNu7TrNdAcnhH8HkXR1oRPhiA1Lwt1S7vIlpjtHDWYMZdl50bnoTcgQ7gQm_ntgUDx4JVMrM-QB8XV1hX9mAEW6ZriY0SP0_R9OPdq5m2-muJFNL3pRjA-6v_Y_S6qzSjYYffZgrdoadU2QNGZECftZr9CdsncoFdCCokolSC_zrHsWdFtsHEQp485C2Yec6l9eEFvObvDn9oyQE2Y83aIRYXBu_wwoGnSIDyY7bHBGO2pcBHvJf1mL7T-vCNS8ro8yy7sWzPVuUKTbll98kLO5zK3ZWeAdFNHLjUf9U-r1ZQYI1n3uqMkaxe1uPAQ4YE-xaiIJWgAVBRvoITy5UgjvSq6F7yn1E2gpedGfPUUzl6F3TMYBGuBe5zsjjGj7sAO1VnhSmwM=w327-h155-no)

계속 진행하다 004013C5 함수를 실행하면 계속 리턴이 되었고, 해당 함수 내부를 확인해 봤다.

![5](https://lh3.googleusercontent.com/9wxyig94eb_c4HRQcTBUQrYteNKsZ6LJeXzVbFJ4kPI9Wxi9JK2uqyFJq3IyLzHHuvKMl8L64e0-NbkGFWCoVQ87jvwegjmwiZAIFOuGcYFoPFbnr-nIs-NidvTQUhxP1RjSeGH1EDWLpq6LP4dEhgySWlhcdSSQBDeU6PFybfVQnPPu1yX65j3VOhI5-jQI8pvw-JhEQfEZmqr2gWI5rx2ZClS_zlr23cd97AQOecK9ZNVWXa5l7dq_dlMr0P4BmTMDgOorO3tZH9WyiiTvNz88Huo8CYirolnlKd4wmrOwlhjCS0l5PKESKLHKXYmVA58-LsnDUHWWro-GmPqVZzX95sWyB0lc_DCJRZdBpIaiwcA2OjGJZvtmgnrpBomUPy5uLydZFbo_ZIqnaUAWv5hGcYWy6a42ANl2LfETJSE-F_VmIeh-YISBGRlBd1SIhhz8v08jZGcupZRKaU5jJ8sPLEnBlA3FMF1YAMJaOslZTL7yUSf_3x3SFb6tMY3ph6m1xK4QNSJMT945TKoD8rVkqJAqwKVK-HkHbvCQ8WPT7IYDMzSFHwLvWU2xxlQAzhYpCJQmsela2NFpiHG7j2bWa1HeyEugFCpw1CiTysh3f5A=w439-h50-no)

보면 12345의 아스키 값들이 그림 5처럼 64개가 들어있는데 그 중 한부분의 31(아스키 정수1) 값을 43과 비교하고있다. 43은 영어 대문자 C의 아스키 값이고 CMP결과로 같지 않으면 리턴 하는 부분으로 바로 점프 하게 된다.

![6](https://lh3.googleusercontent.com/yzk9a84j8oZiRaFDNPP8HpxotUKUH8O-ye_9YHz6xx_WLrZwHRIG0X4THh74o3IyKYmG3P5uPjwW0khwlEpSZJRX3ZVhvkI-Bu6NyPDFkszDAhuAzbEK8GuGJYKDu_QZ5iB9mfLADfWRU1dgOWJ-AVs-Xsmy0gmcZl25vz-SVhbzy9Jv9M2mYialuLWOCUg_FzZ_L9K6HYZnwGBl6TX3VRBA5DoSDx8P9igpfSltwrIBlp7AN7rDZFXxicepFjbjCY6ra0p9TTPKSHC3ceLTahZBeowLJzc36lIi-y6w-B9QOilH50whWmeNT4Le4wdedj8ex8LlnMCUw8M3vd2F9iJMJQrWBXT0I5Wy9J4NlIu9Y0OidOaw5KdUkTEFxBnbSN6rE0w9RaA6dneKlArlb7BBsv4t2-65TfyiIKZPH4c2H0P2tauPNSVjWfKM7scNVmkUPhmNi4J3X7Qz0G8m4HIuxFLUWGAwoIGk59q84AmNaOqDLY1cInN9PF13w3gQszliY1D-EOfQvqkFxoRqkqvRKpYfYaK2FNejrXTYLuDU1ynbOGMzRZ5lFx0JCqXv65h47dnqAzvtlJX0MAZ_uudIGtndOahYTAtc02zfrO5pftw=w525-h81-no)

![7](https://lh3.googleusercontent.com/EoTiNstzwwQKfreXhVuWpTyxDSjcQBGU5_XvQLzUOFHg5Mb07Sfr1bQr9TbiRDl4BOcKCfgggglG8d4kJM8DSkaB_vWwMUMJVpc3T6ztaC4m_jBJsolnsF9pTP1_cNX_msODHKUE7P2z9Xr0ob-MHrfGSRRHFCycuVCi_-D0B8IWlmOZudpKoGyn4HhAExc0yQkixauZpraf764BYYi5c5XPM3YsM4TiR4U6vk7iv9ItyrfTRuDQbgSjuqWDpJpHleKsW0GlEDGCNA85BvGjYALZSr6hHJqaBYIJJ07t1lyA-hI9rhkt26AB288Mg3_Ivx2in9ORzv0YLJj6KYpMjYzLcSnADnENp_59lWsa47sAccf_HvUB2xmYJrWxnK-n041CHfsuk2DQkvgvUyO_3su25k5CNj-uQjokOfQXmPH-CJJmldCOlbkM25p7dfANoSlikZlsaGOzy5aYNeteexihUSxPDZKQoCb5QjZhgwfelpQhtxtcAI_oMHXq7Gzlz5e2VJHQKWM3VD4LqYHzMmsOiUGmsVznYCdWBqBXRwO-t6xGcT7GHQvinKemQrnJDP6ufbN43Qhbum-QWL9I10eXSe1z5eQV5gGmhKGEpXrfwEY=w229-h43-no)

아래로 총 10번을 이런 식으로 비교,점프를 반복하고있고 매번 반복하는 값들은
“CRAAACKED!” 이다. 앞부분의 64번 반복연산 등은 그냥 함정 정도였던 것 같고 결국 문제는 이 함수를 찾아내서 16진수 아스키 값을 확인하는 문제였다.

43 = C
52 = R
41 = A
41 = A
41 = A
43 = C
4b = K
45 = E
44 = D
21 = !

![8](https://lh3.googleusercontent.com/IRh6qirqdg9oA-BKGHDZfrFTxUDJ6sXdBYYTbeEjW1p2pbPM7rVIi5V-ewmL3JsydboaQ7lTf4QNZNJLuBa6wH-vHj4i-paDNQtnxoOyfgj2thO5euy2dP5mEeGjKejtm1BqPGAb_VXMkllBPv1esW3ZxqnF5CkHhIanzZE0BdifRAmUIds58PiCEbU0oCLKwDplvGSBs7nBHSbrhprlyL9R5QjDxtLG0oBlEuoYX_wGnXHc-mZTW6LXpx5Nmh90UBhQdAbZjXLXxhaZrs1ZtXnGFA0mCP2XMExvkE1SIUd_0w07Y1ORggj6hv4tTrOS0bYUwU2gNRLXFz5J4fwSgGuHxO3KxXr9hdWaHILBlSYfqH9_JGXcCl-gw8ufINPTqnQgROzz9rW893-lok4Scq3FL6QsWtXuYNjc6ex-z4t1O3T9dn2IEx84jP9xAVJ20PXxm4lhV1VxXgvkgALjyFlp0I5eb5yVcqa6byV2NMdkeh1wtjw3822gkJeD9mTb5iNIwhQ9oe1l-z9gQr05plrdu6PfIsatDxPtP5Rb8-alS0IxIh5qC8gNJ9tFRoXP_OCa8ugIePQHg0HQEHE-iipUO0g3gJnS10irqxfHAV_ErfU=w525-h569-no)

프로그램을 실행해서 CRAAACKED! 를 입력하면 처음에 임의의 수를 입력할 때 와 달리 종료되지 않고 WELL DONE!라는 메시지박스가 출력된다.

![9](https://lh3.googleusercontent.com/tHA1FJ97Hj7xeuHBNBq2qEagbHFc5qGFjO4RhGaVDI8x1iMCi3g9Yp1N_WfGgdpCqeIqMdr5GQaGTaBAXAU3AdlddpWRyBIwHYscXqeI6nyrDUk3jvpULVVGuzSLCuKEfkUXAhKlLr330Y0cyvJ13TPisp4wMn504DclRHjeB4SED-ilENFbbLO2H6mUU3NLWW4AA9FfBFTHsrHkWTISOsJZDjG1EraEfLWrvDSDX1RFOtlD4pIJeviK_T66EkaKrBO2SEaQ39XpsjEKmgkjEbpioidoqK4xDPIPtMS53xgDaeFW9vhhJDy4M3cxWVy2suszCyE6fbKJzmlH95zuLORPYesB21gXcIZfBNV59gVT1WK5W4LKa0aP3zVfL7oM0NLfwA-7nn1t0VFEscERPpm2e4B7wfmhtwhw3xVsGFe5TLfpYUL_v6r7uo15-DjpCwLPBzMW2669FMOEBghBkzS7rZXl5TZFwwkY7DHU0sSHt3-mil-DWYN_pZPvSaiJ9gqCB1zQ6xz90x3Cg5YNWJd1tUSfUCZh5XQ3sQNZYkmEASQswKXCA95jrxfqpGKT3cp4VUniM4Rx60S50ZEQdb60hV4FJG61122iYwxte3Oe2v4=w402-h273-no)
