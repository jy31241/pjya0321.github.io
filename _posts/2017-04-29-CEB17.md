---
layout: post
cover: 'assets/images/cover6.jpg'
title:  CodeEngn Basic 17
date:   2017-04-30 12:09:12
tags: fiction
subclass: 'post tag-fiction'
categories: 'pjya0321'
navigation: True
logo: 'assets/images/ghost.png'
---



## 17번 문제풀이
-----
문제: Key 값이 BEDA-2F56-BC4F4368-8A71-870B 일 때 Name은 무엇인가
힌트 : Name은 한자리인데.. 알파벳일수도 있고 숫자일수도 있고.. 정답인증은 Name의 MD5 해쉬값(대문자)  

그냥 brute force하면 풀리긴 하지만 일단 분석을 해봤다.
String Reference를 통해 진행되는 코드부분을 확인해서 브레이크포인트를 걸고 시작했다.

![17-1](https://lh3.googleusercontent.com/QF3OV8UrqjJ_QVA7E7CMzAUDi0oLG6xnGiEVfcXj8ktrBoH45OJDIWJNLN2AaT5cwgiN0gTBEP_qGZcFXJknNH2QkFsofTHmceHyxGpkcaobxgTUt5fKDgG1qcncdiYglvCb4N_jefbR2FZkthyZEL0YhRTnJWLBq9-YqtNYM_aAtXwFkEraKgIHskkP5nnJXx1p-AFxE5KooLxOBTWclT3dTrYZKRVIx6B5L7Q6CcHxksXEY4BFtF3k_AFLOFTperGVpgHuVQHE0yYt2SZhdwO-QVtDJYRbsjumh2VGfXkJFitRvIsvzem9w_w2BIr072xr1wYGzqwn761jlxeny_qv-bxIbkC1PLHEkMnRATczZH0tblBAwPVyRdSniL3wrmADoEOzc2ZI8XBAiFgWFzZE6MNJsoDy74dK7zKs4LRL0IwNmnLLQMvG-NPitX2eIg0SHaVfkq2iTlWaRMw9uT7yByJa3RKn5as3HYbtvmsm-y1x61iWt8PXIZXRcoJgtH36hUZyfMa05E7vcHeA2Hxx_otsDdtVP5etGNuu8IduMEKxnqL-mzaMrBNzV3DPhURur4Yx_mmMQKMTjGAOUuT0vYY_UTm4F48IOUGQmd8H80_jgH0=w714-h332-no)

Name값엔 9를를 임의로 입력하고 실행해서 진행하다 보면 그림 13 처럼 Name값을 3글자이상 제한하는 분기점과 최대 1E = 30글자 미만으로 제한하는 부분이 보인다.

![17-2](https://lh3.googleusercontent.com/ytUdHQvMs5N4QX_HcaolrvWw43u5bkc6CH589cHo2SnGbP9ENrL-5hF2rUKc1VoUosMIk213ZP8u0jEvdnmtNLFh3N-iF0QiXAcJfH9sGqPpTVRKxRb3Fx7EubCZCFrb5vDRMD_7CApuMOnaGRcmxcCLSQwCKVoRzlXNuBoOzjdgalBXLFHltT7v5QB60a8QchZmC16w3n6xV44pwNC7CjB1dLou0sBvtJrw3IiH890kf73roveShAPtHuQH7BIgo0Lq7LThUmLAz87H_0PQ1wYWArXPVKb2txTdrTzVuV5_tOWAtslProzBV_3B90nZ1L7EYKjZ8Ci1s6rDNZK5Eyib_E5i3zkT6eHIyPQgW5vM-45IGxykoa-UifRLpZTf_s6QNVEtFd5Wt78ymq5ytltRkiUVeVEi2COX5E2GBdyo-eSTU5czGe4XRJNZvbmv09aYM8lxf1ciXhE7uMFyKchKf9PZ8aXV5G8nSzyNOT6v6ZCBzJ5ASo86j7jf1-eIJAG6sQe2keRmWMkZ4nW1lBG8fxNgUXNtH0drxGbspLd1NNwQbRHQQG6AXc0jMOnMI_J1KTPGjD0SYw4JN2X_clggH8h6nDeEJGcsS2lxtciEhF8=w714-h64-no
)
![17-3](https://lh3.googleusercontent.com/DW7TycRWFE7cGF4rhPhVc7xbUq0MFaGHuwYWvEJlEKEYI3ciNpI5rMPzCQ3qtAStJopydcR4ZBO5ilV8x6RffthqE97jtjoC01qfXCgfqd2yXNdb4bnNY6IeuO9hrnT8uDbLv5PiIEZWoHX9uj1CHUKU-qrpXEAJYXfxXUz3eHczfaY_PiGGs73BxsBTh6HVg2bn3H1_YskCtr2eMemZYgDKID-Gh7c3fSyuW7dnx6sbazf1-OZd7607q9ary1Yiy6P8bbgAvQNI9vn0xq9N6eVfy5WQwJKXHc3yyrYlMrANOnF8YTS5FDoiSN9MddoHCA-kY3Qn3C7w59MvCxxgHi4CL3_ZE6y7zDvzyt6ZNIzmu7Gfu8vnTq4DFqqoNoSHdyMBu6NmRVlrjNeDo89HxSPFHeTRMxnXm5HrnywMe-t5pJD1XGpA4rM6B12LuXlc4d5UIMItm3aLG_DePfkAwA63E1jPDQk2hrIR0nCJHsqiWRnqD1Bp6svO-3-f6S5HjUnoVDq_BZQS2jDxcCEhW7ZQhefpniAq5k9aXoDXDZp2tia82CRxzkZISWNe7oqw2dYIDE9HBaJtlGs8liKqYhDeyHjS9GwLC3yCOKaXGizP9C54P-k=w714-h130-no)

문제에서 Name값은 한자리라고 했기 때문에, 3자리 이상으로 설정한 부분을 1로 수정했다.
일단 여러 함수를 진행하면 0045BBA0에서 MOV한 EDX값이 9의 코드다. 그래서 0045BB9B함수로 들어가서 코드가 어떻게 생성되는지 확인해봤다.

![17-4](https://lh3.googleusercontent.com/s50qjykEDvXK2ZbX8PMm4FjmKRMJcu73EefeesNDlQbFHjZzGhF7gQd7SyfdNMnJZySar7N_sENszd4N1LfUctExMwXGhOkCtEPICQpJh-OvQ_wkNbwLG8G-KpwcjdkuIJChINgUIbN1FmmwhQlHkjK9nehF9vSSUCaQIhGeIvv4iU5ruiC45fFngL-co83Gm3_Mi4Q5ZGtQ5ThWxQhGg86s7bcUfdO3pIA4rqV4tPM0Ew7YIdtdoI4zETjlEO00ESqWUqoKTik6cPhciCC2AyoFx3hnEhUqU63QF9eMaNJzEHVkrlKPIDkFvdcnjgiZdPRNIZRb3s4EqXHeUiDZZJOEozFQYzXM7Ui1uupBW7-x7i320Th5jSudmLt75Nk7U5j4LHFFQmecgFrjH0cIaY0KX7aVpJujLhv2Ehh8h6S1kSp2XHo9a7PJ2qUGh4FDp8fzwy3mc1PbzhrQ7gVN_GuRtqU3iO1pI5KSUNNmWZwciacCyKzsjVWuWdgSU2BysSc_qruQchVUvgIYTmENzliF8KnzJPlpXhZ1uL3EGqL5wzQBks6Ir5ZWfFg51OmNgvKp1UN4ZW4LrgR-d7jzk6UhDCRznNCIh5uO4ntGLeVfCM8=w602-h139-no)

진행하면 그림 16처럼 EDX에 키값의 앞부분인 C542가 보인다. 그 밑으로도 이런 식으로 키값을 생성하는 연산이 3번 더 나오지만, 앞부분만 확인해도 답을 판단 할 수 있을 꺼라 생각하고 C542가 어떻게 만들어 졌는지 확인하면 문제가 해결될 것 같다.

![17-5](https://lh3.googleusercontent.com/2YmAIl4IbUKsddIvea3TQnjzE6-XUQWOPFo7kP_0dMz1muL3BNHw7I-pv7CIYwizWB9JaPjb5q3ml9YtOje5aXbjQFIViZ1Dw2n31yqqyWr--xB2d_cHG_2oUxHMcK0WZwLkw7bQBhHVs1RSTTFw1pE-50haqf7LwwlecEblJ27cmwjFXeJbtQ3cHljQzh0aqXUIMQ2FAmjSe-sIkacFDJSDwRajfdMdqKyeWfHDdvnDvMdg10MhXAk8K_H6SYIaAYONsUYA1nEwhsxP70vPdwC9OAeQpBumtxOBBoCxf0UN3FMjJxvu8LVBXAynKAFr58EAYT_8WEmQwc17iX2qiB-3HBWBOXybC9IFfcrZlEAm-TOM_PYLlqMCNOrxZi3eZfaR_4a3NqWWboJc_7trcP-ZZ2zV5dpspJtXxBKrL-Y-IrHNtNpEEBCLGL3D6crk9p6fzNI1mdZWHhhc96oaKJtd_0hEFMeDHoKeXlJU2hZhQGucx0f93Pnkwz9YC0FdnnBmB0U0Kzrvak3DVgEO0NpCOyup3Be4nfJvLv0U6kvMwOXYk2crS2ENtZ4aLfUSTdoST6Lby4Hd3VfOPeIeZ-kA_yK39WdU-tHZbTSZY_sxbsc=w598-h165-no)
![17-6](https://lh3.googleusercontent.com/wf2Zp30yytUijw4mpbJ2WUxlbqQgd4WrWdQTDlkvNFSwsnHjmvPm4mAzZlLS7YnSA5nzQVgf8uhNY5n4PfjeuZOE7pjmNxkkux0qeTuQgE-WopVq8rqXB52wG72BVPCizk3s_7hAl3wkjUcfW7g9upUI1yrlLl4F_aVtJ2RfFlHZVhmjKfqSXnOSnM5UZUck7OyzJcEfhjPC0IG43HmBHTvtLny7ubI2lW8unC-fG_f7bVSTGxrCKW48b-RQfW587ro4KaJI5fTBpia7ITFRyq1cT-QSUpXa-U-w9aMgYhGLCz94wNtdg9ogEFckGGyd0sML4NgknnxbQ2uiuM7I93H_MOHTosrOn3nOlu-SH6Wv7hve9-JMmmzRiYzTqJaohRNjYJnIs0o3dyhBcsM7HBfVTasgLpUFKuTcxqTAwbhMV1y2t0xFOI77MPGrvf9och2lF6oSs-IK4V4zED7l1BJYAHHaww5dt8oti4-JSp5j996FiNyN-H-lVKq1LVjFWW70QHSbJnz7Y4IutINLRPc1xyuZQZ_HAvlKijk5XDFdVNJjA8679qWJ1OVnZ2oA75ry8bmeVCDxdj1Upn5_qaChG4yXKE1gvlmDQePl6RnnlDM=w227-h31-no)

다시 처음부터 실행해서 연산을 보면 결국 EDX의 값은 ESI값에의해 결정되는데, ESI는 45B8A0에서 9(39)를 입력받고 ESI에 EDX(0)를 더한뒤, 772곱하기ESI 그리고 그값을 EDX에 복사한다. 그리고 ESI를 EDX에 곱하고 그 값을 다시 ESI에 더한다. 그후 다시 474를 곱하고 그후 자기자신을 더한다. 그리고 그 값을 EDX에 보낸다. 그러면 앞4비트가 키의 앞자리가 된다.
정리하면,

1.	ESI에 772를 곱한다.
2.	ESI의 제곱값을 EDX에 넣는다.
3.	ESI에 EDX를 곱한다.
4.	ESI에 474를 곱한다
5.	ESI+ESI를한다.

문제 키값인 BEDA-2F56-BC4F4368-8A71-870B 의 앞부분인 BEDA를 찾으면 된다.
뒷부분도 찾을 수는 있지만 굳이 찾을 필요는 없어서 생략했다.
45B8A0에서 받는 값이, 0~9는 30~39/ A~I는 41~49 / a~I는 61~69다. 아스키 코드값 같다
하나하나 17번 파일로 확인하면 오래 걸리기 때문에 위에 ESI와 EDX를 기준으로 연산하는 코드를 자바로 짜서 0x30~0x7A(0~z)까지 돌려봤다.

![17-7](https://lh3.googleusercontent.com/SIWkQ7fDLh6e8-JutDmNWlGiigsBEvfaZkZ9MYDBNxNODp_-V5XCV2vi3AanCHWBBMy1MpkReu4Oh7vTFC2jPFQqxtnEgocSpPH1c-DHSHI3YVb2vox_4ygLXwvNxSzKgJsWavQcSj7fzWRjQyeFaknOKG6zOfpghYKSMM1uGJQFjMZqnQuDfGEuroc92_CXOsg8vjtkfj1EQc6qm4fOHeYAHft0_CxEEUdCHQ3f2Fu80LQKqWyRjPvyjF6ejhS2ZZXsOKb0_EKXWJ1W5jtWVlDO0JcJj0NHzQD4BJwF4Z3aU53qMqrcKf0vmdSZctf_yD6_vKS_Ju31KXAYYUfx9f4aMkJKZA_O4QEGZOpp-4RjFg_xuoOYi2OSOSx8lNfqRPeWnEA9AbW-nebP0aBqt9wUE2a_Sk59su2qmpvIaCg6_CVnR41_8lx5uw7JRkoeb4g9085Ww3k5NBbyp_3ZQPy-WUkVaCsFAElScxuNbIC7hgSn5HCbYkTalwBuiyzhyYa8NB3t547grTVotafFOJw7OJ_R_5QY9jG2AtdYlCejOL1t6QhjAnxFn4Z6r9veSljpv8Bz0Ok2U7g2vWOFBgiQUzXAZXppp6XIhtQxbTmeDftKxm8=w713-h331-no)

답은 70 16진수 46이다. 아스키코드 표를 찾아보니 영어 “F”다. 글자수를 수정한 17번 파일로 실행해서 확인해보니 맞다.

![17-8](https://lh3.googleusercontent.com/ZH5M_arAQMtcQ25Ab0GycGN5WGm83i5vuSSNIYHQC4_zIUAIFP6n2e5tgHNxbXnYwi644bHp822S0v4HbehhcN3SIfUnF7xviCUL3V0BPe0g0f2fnoz-0d_9MzZTwzRT0g7R-EXFpfvHDKZdeo6RnpVSDmvOtV4OP5TAbTQO-Ee5ll7e3aJN5ouRl5WW-29L0fjB8fjTVVRR_akHRToaim6glo_rzbrRx_TitS7YA31jWrqWhqW4YnjhOPM1RO4j335GEbMwdjru9KNKFqs4tDqmWRE94oUXj6aCJarU94QGcXs5FmO0CwkFEv9YfwAO4eClRrxEEF9Wr4qqtNajyV8tvVhyqw9nROZxRLZYUjBnN4qZoxvqjceDFzCyABKyOYOWyn8plZcVdLia3zjdigNDR5MhvA3cJMbhLtq9SIZCdsHqVFM95cKMX9T7K0ziyoHs7OSmJAF4_fsTdZcvb_FeX51JxrL4I7oyxfzFpl2kpMqqsaiij-6zsuZD1-OWWkYJ9IQXz8wFHmp8pDcvdkQiODh5RC74IF-7MSJ68GRIi1BfhDtN09DicujNCs1p9TqZJAe0dNFG5_nZCXAn3NVQMlvp8Kv1UuxdrNbD6lYPm7g=w508-h183-no)

끝으로 R의 MD5 해쉬값은 ”e1e1d3d40573127e9ee0480caf1283d6” 다
