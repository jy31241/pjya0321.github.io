---
layout: post
cover: 'assets/images/cover6.jpg'
title:  CodeEngn Basic 15
date:   2017-04-30 12:09:10
tags: fiction
subclass: 'post tag-fiction'
categories: 'pjya0321'
navigation: True
logo: 'assets/images/ghost.png'
---


## 15번 문제풀이
-----
문제: Name이 CodeEngn일때 Serial을 구하시오

![15-1](https://lh3.googleusercontent.com/KwqPQ9GVfCZR_uNbFWz91-uOCsxipbdLM33mKcECTbIyjDSRiORrwLT5Mfq_MF--FSrD8ma1a1x9df7j--hXJhtz0LdB6gIhyRL2-hcYeCUWuw6VQ1JqrFpgErYI677B3jAYDnol3QqxKhKQBHrUp-Yo8fJazUiO4-XiU5VKa4lAJeWtTlDNfzSP2CyRV9Tyss7jdWwlv-ygmMeLbz4PWQZB4G9qQmNhjiZRSJ5EGDIYHijI4W4xRmhyQTx3VjTqYzZx53Uc4Vz8LyTpROTrPqKloqHty5_HEnRUCNMeQIr0qwqiCZmTxvjBjRRqVVXWDdBkGowMSBAfuHPdjCsLVL7-W4kXBiU9XT44ML66UqYHoZ0tZA_-i1Sd1UeuCnsgWTQmGKB0nTOn7i9Kv4-GGQwP1C9K90OoeQzXJTOTGmU0LrrfkPALZ-BqwVoYSxFgEwy7m4WCANi0ks20IcyY790k_qgmI7oJKziMwGTVkbuENqHAiFvK-Fays2g-5xtmRi89y107aDK2X6AIsfhZc0RABos4zAl6um35RTJcpGRQq7H3RSrcWmh276VDWkHRHrIPwjkyywgQiicKgOgOZHc0lGIB06chWQTo_XMrKjmdq7X6bDI=w714-h321-no)

처음 실행하여 그림 1 15번 문제의 실행화면 처럼 진행하면 00458B14에서 프로그램을 실행시키는 CALL을 진행한다. 일단 Name에 CodeEngn을 입력하고 Serial부분에 임의로 12345를 입력하고,
Chek it ! 을 클릭하니 그림 2 콘솔창에 입력한 화면같이 Try Again ! 이라는 메시지창이 출력됬다.

![15-2](https://lh3.googleusercontent.com/Zsp7Itef6UNjnNNNdgHOedPnTRDYqGHUe_9IBUmbjDABM8XOYOg1JGWpqHccGnPIlHF1adCkHmtsVQUbvyfyBTArUj0GYL5uuqJUYDkqdMoUb-mTutxU6lW8WEsaunLyboYJBc2_S-Q3vj-lXrnQgV4F1qFNZEM7Zv5oZmQzOQPzuP-C_er8IfoMFV2kusgZVFaYfxeRBNFNleyv-WzJnkmrwd9I2EVW6ipJ4-zRPQTY0w3OiqQhuEZzdeSACTafyWnunW2XKSyAjE90aBwkILxzRgFr7WtGwP2AojNIBYsJLRJFsx1lCB2DokCBu22cBfXwQ0LMvnqm_MkCoOZtwebmdLUCHXN6e7lF8hJgjRW4OB60mu53WyzNSb9kVMUhwj832dOlJzpHGiiQ1707NbOWj-JY7trvGHUzJu2T6OF70_W6cRBc7yDirk0cJVDamSetWZLjERdQ7XeQtPj_1BR1kPTEHkSLIaP9rkrPbRXQ6WqZwQ-G1gmZpd9n1_7FrCO-fodKRj5egzrquH-H40EkgFhZv-4mJG74yM63MT6QTvBFqmIo-MreSWgC2m4VwOKZyaCo6tmBOVBD9BQkarrJiXBrrsprCUrT6cTTJMukx38=w319-h177-no)
![15-3](https://lh3.googleusercontent.com/hsOWPDisv1H84Ip3lDoO8oM-3iqXVmQ9ROJz65tly0J0hTuuGYq-h0hIx4Azmw6s8b37QsTei_57jjM5bJzfFERdVW5XbhmbGhC1d9kFGj1qS-xDiKfQXy_sYCbn5dmux0lR7i_o6zCHmXq3_GSikEGG0G9bCN-RsJ4qTFQvPHFVRTW8OX-vki4vC_SYW7JTOnZOzP9BPX4yLlYXsPwPvA2R-_hFGq9l1Z_RXYqhk3-sIKrDlmx0IZ9blNwaqBkCZiBKyRthZICUWqOVNcdeX2Ci642w_d-UIaOSz-q1Rg6nLNEy7ccVErTMjm9aRjkfKGNjM-QZem7_Bl9w717GR89dnscqlIED5IV-bIaXNvrMBkOUWmkLLt6qIqiKbCYDJkAdZgRR7zM2ChMaP0uq6iV2J7lhsj7ly8K6e6MY7jeOjK4gwHsIMYhsYcrpZU1Fsspodtt7sD0TwhsnwLtd5yUvPZb1TUvna1y0W_PC9cG6ZjFI7yDWkCXvJFH5EDnOkJDSl9hDmErOFSPwGgjlsvzFZRzMhDueXBPVzbeSHworQzqEPqSFnqaudkjl1jUCiRXDSFr4QM5xmL7gyMhJrNlYG-swWjxiU-HXQfo2ri_EuIk=w122-h104-no)

그래서 문자열을 확인해본 결과 “Try Again !” 이 있는 주소가 바로 나왔다. 해당 부분을 확인해보니 그림 4 Try Again 을 확인에서 확인할 수 있듯이 00458837에서 Serial이 맞는지 틀리는지에 대한 분기점을 확인했다. 이제 Name과 Serial을 입력 한 뒤를 확인하기위해 위에 00458800 에 Break Point를 걸고 다시 실행했다.
![15-4](https://lh3.googleusercontent.com/rg1pdS4IvdRdHY8iC5-hRIgtorCoYrC1kvxjHBKaXwuJ_VTCHGKEzKYAfqCfPfqTDjbpa5iFIp-T9AEMRmyu2pRqEdZ-SCdtocrbcRuFDbDGajmKM6qOAhUFc2iZyK-w1sqWitdeu7V1spo0UUTSHPYoStF9uFIEUe3WUdByLRe2RPGl9TfM8sxlupclGx571tOOrQCjbM7nkbyb8v8MlshqozUsw5bgV_cZVT9ajwrwARLT-jcSCD_U00_SdqudKkBzWpf7WLQlolyFatPJv5wK3gTJXs9T9LBJl9HEqgMZ8iYozT-eV_mWqsvXd0kQPYczWQl2P1XDhIkocy1l_MIz4Xbls27X-s4EhQw40fUEgzntr-R6miejUoWu7tCDXeUWg7tGf1X0Ak9E4lkW4JD9LxpfUn6l1rmdJ4MfdDaoQRkzg3id8oeu7eBep6RvAO5Qq_2YpnMPPJ2hZ7p5De9CVEy7ZkYe8yRyiDeluUsuQ-Axz_0yN2laB1ONv0ysfO2pZuXMQBGJUnFYQOG8nIgJhJhgt62sxA4d503TlcNbrCPIXDvXNBNItKpmjxau9uzE_C3h-vLtW2eFG2RDbSVtH9zlSUe5Vtk6xF5u8dT6YjY=w714-h245-no)
![15-5](https://lh3.googleusercontent.com/LTesLSXDrlhYBJLN72GCM_Aq7Cqy2WRFzieS11xgq6i8GLlIrU9RB5u5eTr521bt3b_1pB6LO2Ma0c8Y6L1EP8VnwUOmaI2XgoJGaIGD3DW8P4TgPh-I_d5FyQO7tnGIZ0WuNMD5EG9Mu4PzlcOcWZaMk7YEAnbPrVds7DUZBjU0C2VHpnrpEbQNAJp8Dx9vetuupSfhuJgpjo_r9yHYrTlGGH3NZe8BGNxVJ5H2jkmfLK5t4hFMuxqvaoA6WTrGQuN2Tzz9u2JQOsFevDWO-Xa5hFChGvRySpdh-ZhV7GJ_L2X20HVlE5S9Po9KXlpWx3GCF0qYx0Bzjp3VQq-QlU7b1bg_7yBG0azY8OIG_kEjfBikQZGkeuvmiJyuHA9QY06ra7I0wTI35sX7XuiMkxXJYL6bQJ3LaYbrdCtQFvGDZGBZN7THVKuLNoCqi2-3yfS-R-FvCyD9m90ZaFDBPLlSZCPINnHLSoPp65rgKkss-mPyQ_ctFWHD3dg9tAQM7AbebsL8MCxrWr9PgWXo9eTwyHWAHW6R6UQ2qpOLpY4rKeE9bLw9QbykRmr7uW0j6KidHYbkZ9xxnV9hNplBIpsApfTZXL4A_T4mxUJbFqWgF5w=w714-h376-no)
***
분기점까지 가는 동안 총 3번의 Call이 있는데 일단 문제자체에 집중하기위해 함수내부를 확인하지는 않았다. 대략적으로 Name값을 확인하는 과정이다.
0045882C를 Call하면 EAX값이 12345의 아스키값에서 3039로 바뀐 것을 확인했다.
![15-6](https://lh3.googleusercontent.com/HC816A4Rv4klotDfP9UCXI37FsvMTEWmjGQ2pkn5qDHi97ZqZa_ABrgSGddmDg6joG8mMHd_yc931cXE-SiN4pA11G1_oMAlAcKB0ycFCfDMkV2U6qb72KXOTSimI5rdTAVNSpRisX-ff7a2EmFElA8jBYjNl_aJxpywhXgYS1rNGaC7klPouSQU6hctrIuAqZ0Nq5--dlEEaGv5gnWSG9lyr9RApeygcREf81G5YIoj5Af1Kzb0wjHl4PBBCPa852FjoHWpb7ljx6g5zBMQO1sCTQ_yQ6KQMj9xwBHm1C2_BCeoks2t4yrRvY3orMyvRPQCnCX1DcpeOPmQBJ25dv5TH8ffLwfvc6SibLAT-wjs29H1OE-AELmhFeT-f8uO5BMy_SmP8W8omMEnVCcaUR2zX29v-KLF3K1oJYv9OSkGwXSYX_9iSTmz6tUrK0hIisRaMxBQRpcaInYIiCjYFLVYezNV300PGODZkpN_0rP40UI85nzN5K34fgeLYQsGqNPrsA1Yrt5aowuooqp16WMUmvPp88dK3ou__Bxg0vyqA3lfip4c23h-w8qi8J1boZgbi9u_LZNi_3mJnBFzqUwJdDvY2N6wA6BSsXJTpuxyeGs=w594-h126-no)

그리고 바로 다음부분에서 EAX값과 45B844의 값을 비교하고 그 결과로 Z플레그가 셋팅되서 JNZ로 성공과 실패가 분기된다. 즉 EAX값이 6160이 되면 성공하게 되고 즉 그 값이 CodeEngn의 Serial 값이다. 3039는 16진수 12345 이므로 6160을 10진수로 바꾸면 “24928”이 나온다 정답이다.

![15-7](https://lh3.googleusercontent.com/EB_JweKMFJ6QmvT8Z7BDoqm-vxtafTduU7XVzGjGTz3_21GqCfim3PL3TgrX8xZlq5vhxJcO_mjI5rmlmxXh2YHtsIkPJ-LfgxPqvkjl0Rze1-nC_HgxKDhoav6bGBXwrXgn01VdPSqcjW3rXeFo_C21IJiGcESlgd7onQhGyRkRc2EnV_kUy9NwTunaLO9Jbf0tqco2o79LIj5reJKQ1WKixyiqFrBRLXOl3PbuXyGQqpJT_p_iiYrMkO1PVGFApvghnwY7nYgzSBmgM0sZYgjMWvX_eCEshA0JIJyW2JtlZdwt7i1ZxUEDTru21SDOPowY4zgV5Nc_XQLKXZUPj0kgXS7kYuCbe_LuQ6Z19JgSNksVKbQI6hhrbWqN5t3TE9TNXu62O9c9UuNDoFlaoxvz820vLivtl0ZF4v2hh0NfV7xefhNUATeptqZO9ZWCh72aeg8oGHwW8JcwvOhuhPMlHn75NIbdCm3SJ5Y5Rkn9ljoOQ80X95E47hncitTblkCyOqrVrtqh-3nKLAWdzAX_3rDxu0yRXqh12iqb-KdS9819Xw2ybrTN8x3RFcuf1Oio0b0z36gMM-8IiQ_sJ2eRuGMvwOr1tBfO1hawEMHzfRk=w563-h68-no)
![15-8](https://lh3.googleusercontent.com/-VNVETM7tE42Iihpeqjy2QkOQkKVH_JOPeYLlcdxpAcksb9DSErjszRspWqGaMBfcxg24074ZyPFPM_SVZt70GqRusR5a8b9uqgDULQOZJe96DWHSyvXEVr86m3m4YRRNNWmYRoWuSPntrtFVPNzsjD-f8QoyBCw0Ds_WfcMXomGsaLC4zU0IBwTE5O13bYoUgGw1_7aTEaakKt9u_0ZlxpOJxIb7J3eCjnVqWGT0cD3IgIrrZkVbLDwCbtyk1LB3t02pgCt02xzzYpUNNG-bNZVkhbEZZPDFSt2p2-EVo5EmSxdEDZ3LN1ceAqxfcp91u6TcCOCLNfUTAr_5hm26ctiWomOE3zSpi6QJq4E9l8ifnuU-Jy1IZosoD1X4yquX_OLCeqzdOLhjSXfGrdrMnq_FhBSQOUriuDmT2exImvcwS04mz9OZInGOCmQxjJNQPmchJ3fW1A5geIUCvdUPCrsnzY3-VopdCi2m5RqYHZA1OShatMOkppTiIYqClF3TdEQuoY1hrch1pyWwnMUzrm7J5oaz24QX8XYV_8NBUu9jP9-WHmU1fYZGwzd0jMVB3s5K601NnqHDNwweaLbOjECINhdzYA89xn5prAhUh41vUA=w320-h178-no)
![15-9](https://lh3.googleusercontent.com/uQkHWHRv3IWCKw5nLR_cGaeZCxgOn7ANwEYDKwqOxV5ugLNZOmKhRF6ynJJ5aOa9skq8WSjjQuo1U_uwOorsxAOfTD2JSt9ZW6ZXyfD8qeJWqzfHiLYEtEo4toD_PIIRH4MaVjkg8z3-3ExJeAuvtV9is1sHwdWsXsfFjrmuYCOGZv-FFVJcR5sHFJI7wmk5cZtYLfEDsx9bt76YZsuazKNR6AYml8pD2VyaMqpEtoxLru6eMfPpfL7ITcoNEl1qBDwNYWGYkgdsWjWEDz37RgO9bCtQTkEyrZqFgGIW55H6Oc1dga-PcIeTx33Zq3mM1ylSebxtd5qARMKO2JICILzHjzmfFKNeaMi7lGLra9qYKVLeEQR1rsAjecUE_cUlPRoOfr2gHYpBUwokfnJ7YVWmUZ8G1gUZFzadhYxpvveHLym32MsjkHf6LRYCZgz-5U3qVCeH6FSN8UAyB4qvUN4klw74x1t7PWNBd8hGkzOa5vShhH0ZLh4UJ6Leyf346QXsbQ_1iEdS8lMzBprWE0oPUH6T9s8Xj3f9fcB9kvaV9KjJzqlPIbhyAaPRNcTQIM8iqLzbrePIZuLA_BFm8pLBObloMMgCgIhA6rKSHMKfVjI=w553-h104-no)

처음엔 Name과 Serial값을 비교하기전 함수들이 값을 변화시키거나 함수안에서 비교 할 줄 알고 Call들을 확인했는데, 생각보다 간단한 문제였다.
